| Gate | Criterio PASS | Comando Exacto (preserva RC) | Evidencia Requerida | Notas |
|------|---------------|------------------------------|---------------------|-------|
| **G1: Repo Reproducible** | `pytest -q` colecta tests sin "ERROR collecting" | `uv run pytest --collect-only -q 2>&1; echo "RC=$?"` | (1) stdout crudo, (2) RC=0 indica NO collection errors | `--collect-only` es más rápido que run completo |
| **G2: Path Hygiene** | `_ctx/context_pack.json` NO contiene paths absolutos ni URIs | `uv run trifecta ctx sync -s . >/dev/null 2>&1 && rg -n '"/Users/\|"/home/\|file://' _ctx/context_pack.json; echo "RC=$?"` | (1) sync exit code, (2) rg RC=1 (no matches) es PASS | rg retorna 1 cuando no hay matches (EXITO) |
| **G3: ast symbols operativo** | `uv run trifecta ast symbols sym://python/mod/context_service` NO retorna FILE_NOT_FOUND | `uv run trifecta ast symbols sym://python/mod/context_service 2>/dev/null \| jq -r '.status, .errors[0].code // "null"'; echo "RC=$?"` | (1) status=ok, (2) code≠FILE_NOT_FOUND, (3) RC=0 | jq parse y extrae código si existe |
| **G4: Telemetría** (opcional) | JSONL existe con campos obligatorios | `test -f _ctx/telemetry/events.jsonl && head -1 _ctx/telemetry/events.jsonl \| jq -c 'has("run_id"), has("segment_id"), has("timing_ms")'; echo "RC=$?"` | (1) file exists, (2) todos los campos=true, (3) RC=0 | Validación de schema sin leer todo el a
