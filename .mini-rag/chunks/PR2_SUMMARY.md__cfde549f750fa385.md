#### `tests/unit/test_ast_lsp_pr2.py` (~335 lines)
- **Coverage:**
  - 5 tests: SymbolQuery parsing
  - 4 tests: SymbolResolver resolution + fail-closed
  - 4 tests: SkeletonMapBuilder caching
  - 8 tests: LSP state machine
  - 2 tests: Bytes tracking
  - 1 test: Integration selector + skeletons
- **Total:** 24 tests
