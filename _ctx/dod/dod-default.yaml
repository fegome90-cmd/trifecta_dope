version: 1
dod:
  - id: DOD-DEFAULT
    title: "DoD estándar"
    required_artifacts:
      - "tests.log"
      - "lint.log"
      - "diff.patch"
      - "handoff.md"
      - "verdict.json"
    required_checks:
      - name: "verify"
        commands:
          - "scripts/verify.sh"
    rules:
      - "Sin evidencia reproducible: FAIL"
      - "Scope fuera de límites: FAIL"
  - id: DOD-LINTER_AB
    title: "DoD linter A/B"
    required_artifacts:
      - "_ctx/logs/ab_off.log"
      - "_ctx/logs/ab_on.log"
      - "verdict.json"
    required_checks:
      - name: "ab_linter_tests"
        commands:
          - "uv run pytest -q tests/integration/test_ctx_search_linter_ab_controlled.py"
    rules:
      - "OFF=0 hits, ON>0 hits (evidencia en logs)"
      - "No cambiar formato de output sin actualizar el parser de tests"
  - id: DOD-REPRODUCIBILITY
    title: "DoD reproducibilidad"
    required_artifacts:
      - "tests.log"
      - "gate.log"
      - "verdict.json"
    required_checks:
      - name: "acceptance_tests"
        commands:
          - "uv run pytest -q tests/acceptance/test_cli_smoke_real_use.py"
    rules:
      - "Evidencia reproducible guardada en logs"
