version: 1
id: WO-0049
epic_id: E-SCALE
title: Agregar DeprecationWarning a segment_utils.py
priority: P0
status: done
owner: felipe_gonzalez
branch: job/WO-0049
worktree: ../.worktrees/WO-0049
scope:
  allow:
  - src/infrastructure/segment_utils.py
  - tests/unit/test_segment_utils_deprecation.py
  deny:
  - .env*
  - '**/production.*'
verify:
  commands:
  - uv run pytest tests/unit/test_segment_utils_deprecation.py -v
dod_id: DOD-DEFAULT
execution:
  engine: trifecta
  required_flow:
  - session.append:intent
  - ctx.sync
  - ctx.search
  - ctx.get
  - session.append:result
  segment: .
trace:
  ticket: null
  related_wos:
  - WO-0048
claim_links:
  requirements:
  - DeprecationWarning con stacklevel=2 en todas las funciones deprecated
  - Test que verifica que el warning se emite
  - "Documentaci\xF3n breve en docstring"
objective: Agregar DeprecationWarning a segment_utils.py para que cualquier uso directo sea detectable.
  El CI guard excluye este archivo, por lo que necesitamos warnings como segunda linea de defensa.
started_at: '2026-02-15T20:42:42.050565+00:00'
result: done
verified_at_sha: 3fe9e665a84d893669d0e920e7db30a904e8e254
assumptions:
- warnings.warn funciona correctamente en Python
constraints:
- Mantener backward compatibility (las funciones siguen existiendo)
- "No romper c\xF3digo existente que use segment_utils"
deliverables:
- warnings.warn con DeprecationWarning y stacklevel=2 en resolve_segment_root()
- warnings.warn con DeprecationWarning y stacklevel=2 en compute_segment_id()
- Test unitario que captura y verifica los warnings
- Docstrings actualizados indicando "use SegmentRef SSOT"
diff_budget:
  max_files: 3
  max_loc: 100
stop_conditions:
  max_iterations: 2
  max_fail_verify: 1
closed_at: '2026-02-15T20:49:36.434544+00:00'
