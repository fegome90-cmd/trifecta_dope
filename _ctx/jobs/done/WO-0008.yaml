version: 1
id: WO-0008
epic_id: E-0001
title: A/B Linter Reproducibility (OFF=0, ON>0) en fixture sintético
priority: P1
status: done
owner: null
scope:
  allow:
  - tests/integration/test_ctx_search_linter_ab_synthetic.py
  - configs/anchors.yaml
  - configs/aliases.yaml
  - docs/reports/linter_ab_reproducibility.md
  - _ctx/logs/ab_*.log
  deny:
  - .env*
  - src/**
verify:
  commands:
  - uv run pytest -xvs tests/integration/test_ctx_search_linter_ab_synthetic.py
dod_id: DOD-LINTER_AB
execution:
  engine: trifecta
  required_flow:
  - session.append:intent
  - ctx.sync
  - ctx.search
  - ctx.get
  - session.append:result
  segment: .
verified_at_sha: f2c16d761834bf00b60a5ed86a37f90d76853f9f
evidence_logs:
- _ctx/logs/wo0008_ab_test_execution.log
x_legacy: true
x_final_report: docs/reports/wo0008_ab_linter_reproducibility.md
x_branch: job/WO-0008-ab-linter-synthetic
x_worktree: ../wt-WO-0008
x_objective: 'Validar que el linter A/B es reproducible en fixture sintético:

  - OFF (--no-lint): query vaga retorna 0 hits

  - ON (TRIFECTA_LINT=1): misma query retorna >0 hits por expansión


  Depende de WO-0007 (bootstrap funcional).

  '
x_deliverables:
- tests/integration/test_ctx_search_linter_ab_synthetic.py con fixture mini
- Test OFF=0, ON>0 validado en fixtures autogenerados
- docs/reports/linter_ab_reproducibility.md (comandos + evidencia)
x_acceptance_criteria:
- Fixture genera configs/anchors.yaml + aliases.yaml válidos
- Query vaga 'servicio' (1 token) dispara expansión en ON
- 'OFF: hits == 0 o ids == []'
- 'ON: hits > 0 o ids no vacíos'
- Test pasa en limpio (no depende de _ctx preexistente del repo principal)
diff_budget:
  max_files: 15
  max_loc: 400
x_dependencies:
- wo_id: WO-0007
x_risks:
- Linter config podría no disparar expansión si anchors/aliases mal diseñados
- Query podría no matchear contenido del fixture
x_mitigation:
- Diseñar fixture con token explícito que esté en anchors
- Validar config con test unitario previo
x_notes: 'Splitteado de WO-0007 para aislar linter A/B de bootstrap validation.


  WO-0007 valida: create -> sync -> pack creation (sin linter).

  WO-0008 valida: linter OFF=0 ON>0 en fixture.

  '
finished_at: '2025-12-31T23:59:59Z'
