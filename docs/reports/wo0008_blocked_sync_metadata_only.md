# WO-0008 Blocked: ctx sync Metadata-Only Indexing

**Status**: BLOCKED  
**Blocker**: `ctx sync` indexes only `_ctx` metadata in synthetic fixture; repo content missing  
**Diagnosed**: 2026-01-06T00:46:00-03:00  
**SHA**: (will be added at commit)

---

## Executive Summary

WO-0008 (A/B Linter Reproducibility) is blocked because `ctx sync` currently **only indexes `_ctx` metadata files** (skill.md, prime, agent, session) and **does not index repo content** (docs/, src/) in synthetic test fixtures.

This makes A/B linter testing impossible: there's no content to search, so linter expansion cannot be validated.

---

## Checkpoint Evidence

| Checkpoint | Question | Evidence | Result |
|------------|----------|----------|--------|
| 1 | Pack created? | 12K, 4 chunks | ✅ PASS |
| 2 | Token in pack? | `grep "SERVICIO_ANCHOR_TOKEN" pack.json` = empty | ❌ FAIL |
| 3 | Search finds token? | "No results found for query: 'SERVICIO_ANCHOR_TOKEN'" | ❌ FAIL |
| 4 | What's in pack? | skill.md, prime, agent, session (all `_ctx/*`) | ❌ Only metadata |
| 5 | Repo content indexed? | docs/servicio.md exists but NOT in pack | ❌ MISSING |

---

## Pack Contents (Actual)

**Fixture**: `/tmp/wo0008_test.bsNGD`

**Expected in pack**:
- `docs/servicio.md` (user content with token "SERVICIO_ANCHOR_TOKEN")

**Actually in pack** (4 chunks):
```
Chunk 0: skill.md (autogenerated by trifecta create)
Chunk 1: prime_wo0008_test_bsngd.md (autogenerated)
Chunk 2: agent_wo0008_test_bsngd.md (autogenerated)
Chunk 3: session_wo0008_test_bsngd.md (autogenerated)
```

**Missing**: `docs/servicio.md`

---

## Root Cause

`ctx sync` currently has a built-in assumption or filter that **only processes `_ctx` directory files** for indexing. User-created content in `docs/`, `src/`, etc. is **not indexed** in synthetic fixtures.

This may be:
- Hardcoded path filter in sync logic
- Issue with segment root detection
- Feature not yet implemented (sync assumes content comes from git-tracked files only?)

---

## Implication for WO-0008

A/B linter test spec requires:
1. Query "servicio" (vague) → linter expands → search finds content
2. Assertion: OFF=0 hits, ON>0 hits

**Blocker**: Step 1 fails because there's no content to find. Linter expansion is irrelevant if pack is empty.

---

## Recommended Action

**Pause WO-0008** and create **WO-0009 (P0)**: "ctx sync must index repo content (docs/src), not just _ctx metadata"

**WO-0009 Acceptance**:
- In fixture: `docs/servicio.md` appears in `context_pack.json`
- `grep "SERVICIO_ANCHOR_TOKEN" pack.json` ≠ empty
- `ctx search --query "SERVICIO_ANCHOR_TOKEN"` → hits > 0

---

## Supporting Logs

**Debug logs**: `_ctx/logs/wo0008_debug/`
- `04_ls_pack.log` - Pack size (12K)
- `06_pack_grep_token.log` - grep result (empty)
- `08_search_token.log` - Search result ("No results found")
- `10_search_servicio_on.log` - Linter ON ("No results found")

**Python pack introspection**:
```bash
source _ctx/logs/wo0008_debug/00_env.txt
python3 -c "import json; d=json.load(open('$TMP_REPO/_ctx/context_pack.json')); print([c['source_path'] for c in d['chunks']])"
```

Output:
```
['skill.md', 'prime_wo0008_test_bsngd.md', 'agent_wo0008_test_bsngd.md', 'session_wo0008_test_bsngd.md']
```

---

## Next Steps

1. ✅ Mark WO-0008 status: `blocked`
2. ✅ Create WO-0009 with RED test demonstrating issue
3. ⏸️ Implement WO-0009 fix (separate task)
4. ⏸️ Resume WO-0008 after WO-0009 passes

---

**END OF BLOCKER REPORT**
